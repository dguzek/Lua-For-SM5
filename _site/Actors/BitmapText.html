<!DOCTYPE html>
<html>
	<head>
	    <meta charset='utf-8'>
	    <meta http-equiv="X-UA-Compatible" content="chrome=1">
	    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<link href='http://fonts.googleapis.com/css?family=Open+Sans:400,400italic,700' rel='stylesheet' type='text/css'>
	    <link rel="stylesheet" type="text/css" href="../../stylesheets/stylesheet.css" media="screen">
	    <link rel="stylesheet" type="text/css" href="../../stylesheets/github-light.css" media="screen">
	    <link rel="stylesheet" type="text/css" href="../../stylesheets/print.css" media="print">

	    <!--[if lt IE 9]>
	    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	    <![endif]-->

	    <title>Lua for SM5: Chapter 1 – BitmapText</title>
	</head>
	
	<body>
	
	<header>
	<div class="inner">
		<div class="title">
			<a href="/">
				<h1>
					Lua for SM5
					<img src="/images/sm5-logo.png">
				</h1>
			</a>
			<h2>Lua Scripting for StepMania 5</h2>
			
		</div>
		<a href="https://github.com/dguzek/Lua-For-SM5" class="button">
			 <small>View project on</small> GitHub
		</a>
	</div>
</header>	
	<div id="content-wrapper">
		<div class="inner clearfix">
			<section id="main-content">
				<h2 id="section-12--bitmaptext">Section 1.2 – BitmapText</h2>

<p><em>BitmapText</em> Actors are used to display text on the screen. As Lua tables, they
have two unique elements, <code>Font</code> and <code>Text</code>.  <code>Font</code> should be set to
any font in the current or <em>_fallback</em> theme’s <em>./Font</em> directory. <code>Text</code> should
be set to a string value, but it can be left empty or not declared at all if you intend
to programmatically set the text later with the <code>settext()</code> method.</p>

<p>```lua
– In SM5, it is possible (and encouraged!) to create local variables
– that have scope over the current file, like this.
local phrases = {
	“There’s the boys.”,
	“Just move faster.”,
	“Worst in the world.”,
	“#bottomstruggles”
}</p>

<p>return Def.ActorFrame{
	InitCommand=cmd(sleep, 9999),</p>

<pre><code>-- Remember that queuecommand() waits until the next tick of the engine's
-- game loop to execute whatever command we are queueing.
OnCommand=cmd(queuecommand, "ChooseAPhrase"),
ChooseAPhraseCommand=function(self)
	-- When passed an integer, math.random() returns a random
	-- integer that is no greater than the number you pass it,
	-- but at least 1.  So, in this case, since #phrases = 4
	-- i will be assigned to 1, 2, 3 or 4.
	local i = math.random( #phrases )

	-- In contrast, playcommand() will attempt to execute immediately.
	-- playcommand() also allows us to pass a table of arguments to
	-- the next command we want to run.  In this way, we can pass
	-- variables that are otherwise local to this function of this
	-- ActorFrame to the desired function of the desired BitmapText.
	self:GetChild("CatchPhrase"):playcommand("Update", {PhraseIndex=i})
end,

Def.BitmapText{
	Name="CatchPhrase",
	Font="Common normal",
	InitCommand=cmd(diffuse, color("#FEDCBA"); Center),
	UpdateCommand=function(self, params)
		-- The "params" argument comes in as a table with a single element,
		-- "PhraseIndex"; use that index to get one of the string phrases from
		-- the phrases variable and set this BitmapText to display that phrase.
		self:settext( phrases[ params.PhraseIndex ] )
	end
} } ```
</code></pre>

<p>The example above is admittedly rather artificial for the sake of demonstrating how to pass
variables when issuing a <code>playcommand()</code> call.  The random index <code>i</code> could have just
as easily been generated at the top of the file next to <code>local phrases</code> and not needed to
be passed between the Actors’ functions.</p>

<p>Still, it is good to know that this can be done.  Keeping variables local (to a file, to a function,
etc.) is good practice to mitigate polluting the global Lua namespace with an abundance of
single-use variables.  In this regard, it can be helpful to know as many ways to pass those
local variables (between files, between functions, etc.) as possible.</p>

<hr />

<p>Finally, if you sift through enough SM5 theme code, you’ll likely encounter a helper function
<code>LoadFont()</code>.  It was essentially a wrapper method for Def.BitmapText{} that served to
workaround some of BitmapText’s quirks/bugs that have since been fixed.  There should be
no need to use it any longer.</p>

			</section>

    		<aside id="sidebar">
				<a href="https://github.com/dguzek/Lua-For-SM5/zipball/master" class="button">
					<small>Download</small>
					.zip file
				</a>
				<a href="https://github.com/dguzek/Lua-For-SM5/tarball/master" class="button">
					<small>Download</small>
					.tar.gz file
				</a>

      			<p class="repo-owner">
					Project maintained by <a href="https://github.com/dguzek">dguzek</a>.
				</p>

      			<p>
					This page was generated by <a href="https://pages.github.com">GitHub Pages</a>
					using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
	  			</p>
  			</aside>
		</div>
	</div>
			
</body>
	
</html>